<ng-include src="'public/plugins/grafana-kairosdb-datasource/partials/metric.names.loading.html'" ng-if="!ctrl.datasource.initialized"></ng-include>
<query-editor-row query-ctrl="ctrl" can-collapse="true" has-text-edit-mode="true" ng-if="ctrl.datasource.initialized">
    <div class="gf-form" ng-if="ctrl.target.editorMode">
      <textarea
        rows="3"
        class="gf-form-input"
        ng-model="ctrl.target.rawQuery"
        spellcheck="false"
        placeholder="Raw JSON Query"
        ng-model-onblur
      ></textarea>
    </div>
    <div ng-if="!ctrl.target.editorMode">
      <ng-include src="'public/plugins/grafana-kairosdb-datasource/partials/metric.name.row.html'"></ng-include>
      <ng-include src="'public/plugins/grafana-kairosdb-datasource/partials/tags.editor.html'"></ng-include>
      <ng-include src="'public/plugins/grafana-kairosdb-datasource/partials/group.by.editor.html'" ng-if="ctrl.tags.initialized && ctrl.tags.multiValuedTags"></ng-include>
      <label ng-if="ctrl.tags.initialized && ctrl.datasource.enforceScalarSetting">
          <input type="checkbox" ng-model="ctrl.target.query.overrideScalar">
          Advanced: Check this box to override requiring a scalar aggregator. This is necessary if you want to plot a heatmap, for example.
      </label>
      <aggregators ng-if="ctrl.tags.initialized" available-aggregators="ctrl.aggregators" entries="ctrl.target.query.aggregators"></aggregators>
      <ng-include src="'public/plugins/grafana-kairosdb-datasource/partials/time.override.editor.html'" ng-if="ctrl.tags.initialized"></ng-include>
    </div>
</query-editor-row>
